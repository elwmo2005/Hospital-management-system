<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drug Inventory Management - Hospital Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background: #f4f4f4;
            color: #333;
            height: 100vh;
            overflow-x: hidden;
        }

        /* Top Header Bar */
        .apex-header {
            background: #13191c;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .oracle-logo {
            color: #ff0000;
            font-weight: bold;
            margin-right: 20px;
        }

        .header-right {
            display: flex;
            align-items: center;
            color: #ffffff;
            font-size: 13px;
        }

        .user-info {
            display: flex;
            align-items: center;
            margin-right: 15px;
        }

        .user-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #3d9aef;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            margin-right: 8px;
        }

        /* Main Layout */
        .main-layout {
            display: flex;
            height: calc(100vh - 50px);
        }

        /* Left Sidebar Navigation */
        .sidebar {
            width: 240px;
            background: #2d5563;
            color: #ffffff;
            overflow-y: auto;
            flex-shrink: 0;
        }

        .nav-item {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .nav-item.active {
            background: rgba(255,255,255,0.2);
            border-left: 3px solid #3d9aef;
        }

        .nav-item .icon {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        .nav-item.has-submenu .arrow {
            margin-left: auto;
            font-size: 10px;
        }

        .nav-submenu {
            background: rgba(0,0,0,0.2);
            display: none;
        }

        .nav-submenu.open {
            display: block;
        }

        .nav-submenu .nav-item {
            padding-left: 45px;
            font-size: 13px;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            background: #f4f4f4;
            overflow-y: auto;
        }

        .content-header {
            background: #ffffff;
            padding: 15px 25px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .breadcrumb {
            font-size: 13px;
            color: #666;
            margin-bottom: 5px;
        }

        .breadcrumb a {
            color: #3d9aef;
            text-decoration: none;
        }

        .page-title {
            font-size: 24px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        /* Main Container */
        .main-container {
            padding: 25px;
            max-width: 1600px;
        }

        /* Three-column layout for inventory */
        .inventory-layout {
            display: grid;
            grid-template-columns: 380px 1fr 350px;
            gap: 20px;
            height: calc(100vh - 140px);
        }

        /* Left Panel - Inventory Search & Filters */
        .inventory-search {
            background: white;
            border: 1px solid #d0d0d0;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
        }

        .search-filters {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            background: #f8f9fa;
        }

        .filter-group {
            margin-bottom: 12px;
        }

        .filter-label {
            font-size: 11px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
            display: block;
        }

        .filter-input {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 12px;
            height: 28px;
        }

        .filter-select {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 12px;
            height: 28px;
        }

        .filter-row {
            display: flex;
            gap: 8px;
        }

        .filter-row .filter-input,
        .filter-row .filter-select {
            flex: 1;
        }

        .search-button {
            width: 100%;
            padding: 8px 12px;
            background: #3d9aef;
            border: 1px solid #3d9aef;
            border-radius: 3px;
            color: white;
            font-size: 12px;
            cursor: pointer;
            margin-top: 10px;
        }

        /* Inventory Summary Cards */
        .inventory-summary {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            background: #f8f9fa;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .summary-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 3px;
            padding: 8px;
            text-align: center;
            font-size: 11px;
        }

        .summary-number {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 2px;
        }

        .summary-label {
            color: #666;
        }

        .summary-card.alert {
            border-color: #ffc107;
            background: #fff9c4;
        }

        .summary-card.critical {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .drugs-container {
            flex: 1;
            overflow-y: auto;
        }

        .drug-item {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background 0.2s;
            position: relative;
        }

        .drug-item:hover {
            background: #f8f9fa;
        }

        .drug-item.selected {
            background: #e8f4fd;
            border-left: 3px solid #3d9aef;
        }

        .drug-item.low-stock {
            border-left: 3px solid #ffc107;
        }

        .drug-item.out-of-stock {
            border-left: 3px solid #dc3545;
        }

        .drug-item.expiring-soon {
            border-left: 3px solid #fd7e14;
        }

        .drug-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 6px;
        }

        .drug-name {
            font-weight: 600;
            font-size: 13px;
            color: #333;
        }

        .stock-level {
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 9px;
            font-weight: 500;
        }

        .stock-adequate { background: #d4edda; color: #155724; }
        .stock-low { background: #fff3cd; color: #856404; }
        .stock-out { background: #f8d7da; color: #721c24; }
        .stock-expiring { background: #ffeaa7; color: #856404; }

        .drug-details {
            font-size: 11px;
            color: #666;
            margin-bottom: 6px;
        }

        .drug-meta {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: #666;
        }

        .expiry-indicator {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .expiry-ok { background: #28a745; }
        .expiry-warning { background: #ffc107; }
        .expiry-critical { background: #dc3545; }

        /* Center Panel - Inventory Management */
        .inventory-content {
            background: white;
            border: 1px solid #d0d0d0;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
        }

        .inventory-tabs {
            display: flex;
            border-bottom: 1px solid #e0e0e0;
            background: #f8f9fa;
        }

        .inventory-tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.2s;
        }

        .inventory-tab.active {
            background: white;
            border-bottom-color: #3d9aef;
            color: #3d9aef;
        }

        .inventory-tab:hover:not(.active) {
            background: #e9ecef;
        }

        .inventory-details {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        /* Drug Information Display */
        .drug-info-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .drug-info-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .drug-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .drug-subtitle {
            font-size: 14px;
            color: #666;
            margin-top: 2px;
        }

        .drug-status-badge {
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 500;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
        }

        .info-label {
            font-weight: 600;
            color: #333;
        }

        .info-value {
            color: #666;
        }

        /* Stock Details Table */
        .stock-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            overflow: hidden;
        }

        .stock-table th {
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            padding: 10px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            color: #333;
        }

        .stock-table td {
            border-bottom: 1px solid #f0f0f0;
            padding: 10px 12px;
            font-size: 12px;
            vertical-align: top;
        }

        .stock-table tr:hover {
            background: #f8f9fa;
        }

        .lot-expired {
            background: #f8d7da;
            color: #721c24;
        }

        .lot-expiring {
            background: #fff3cd;
            color: #856404;
        }

        /* Transaction History */
        .transaction-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .transaction-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 10px;
        }

        .transaction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .transaction-type {
            font-weight: 600;
            font-size: 13px;
            color: #333;
        }

        .transaction-date {
            font-size: 11px;
            color: #666;
        }

        .transaction-details {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }

        /* Right Panel - Actions & Alerts */
        .inventory-panel {
            background: white;
            border: 1px solid #d0d0d0;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
        }

        .panel-section {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .panel-section:last-child {
            border-bottom: none;
        }

        .section-title {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .section-icon {
            margin-right: 8px;
            color: #3d9aef;
        }

        /* Barcode Scanner */
        .barcode-scanner {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border-radius: 4px;
            padding: 12px;
            text-align: center;
            margin-bottom: 15px;
        }

        .scanner-icon {
            font-size: 20px;
            margin-bottom: 6px;
        }

        .scanner-input {
            width: 100%;
            padding: 6px 8px;
            border: none;
            border-radius: 3px;
            font-size: 12px;
            text-align: center;
            margin-top: 6px;
        }

        /* Alert Cards */
        .alert-card {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 11px;
            color: #856404;
        }

        .alert-card.critical {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }

        .alert-card.info {
            background: #cce5ff;
            border-color: #b3d7ff;
            color: #004085;
        }

        .alert-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        /* Action Buttons */
        .action-button {
            width: 100%;
            padding: 10px 12px;
            margin-bottom: 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            background: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
            text-align: left;
            display: flex;
            align-items: center;
        }

        .action-button:hover {
            background: #f8f9fa;
            border-color: #3d9aef;
        }

        .action-button.primary {
            background: #3d9aef;
            border-color: #3d9aef;
            color: white;
        }

        .action-button.success {
            background: #28a745;
            border-color: #28a745;
            color: white;
        }

        .action-button.warning {
            background: #ffc107;
            border-color: #ffc107;
            color: #333;
        }

        .action-button.danger {
            background: #dc3545;
            border-color: #dc3545;
            color: white;
        }

        .action-icon {
            margin-right: 8px;
            width: 16px;
        }

        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 15px;
        }

        .stat-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 3px;
            padding: 8px;
            text-align: center;
            font-size: 11px;
        }

        .stat-number {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 2px;
        }

        .stat-label {
            color: #666;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 12px;
        }

        .form-label {
            font-size: 12px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
            display: block;
        }

        .form-input {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 12px;
            height: 28px;
        }

        .form-textarea {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 12px;
            min-height: 60px;
            resize: vertical;
            font-family: inherit;
        }

        .form-select {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 12px;
            height: 28px;
        }

        /* Buttons */
        .btn {
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 12px;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            height: 28px;
            min-width: 80px;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #3d9aef;
            border-color: #3d9aef;
            color: #ffffff;
        }

        .btn-secondary {
            background: #6c757d;
            border-color: #6c757d;
            color: #ffffff;
        }

        .btn-success {
            background: #28a745;
            border-color: #28a745;
            color: #ffffff;
        }

        .btn-warning {
            background: #ffc107;
            border-color: #ffc107;
            color: #212529;
        }

        .btn-danger {
            background: #dc3545;
            border-color: #dc3545;
            color: #ffffff;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            padding: 0;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            background: linear-gradient(to bottom, #f8f8f8, #e8e8e8);
            border-bottom: 1px solid #d0d0d0;
            padding: 15px 20px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }

        .modal-body {
            padding: 20px;
        }

        /* Alerts */
        .alert {
            padding: 10px 15px;
            border-radius: 4px;
            margin-bottom: 15px;
            font-size: 12px;
        }

        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .alert-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .alert-info {
            background: #cce5ff;
            border: 1px solid #b3d7ff;
            color: #004085;
        }

        .alert-danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        /* Region Header */
        .region-header {
            background: linear-gradient(to bottom, #f8f8f8, #e8e8e8);
            border-bottom: 1px solid #d0d0d0;
            padding: 10px 15px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .region-header .icon {
            margin-right: 8px;
            color: #3d9aef;
        }

        /* Loading States */
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3d9aef;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .inventory-layout {
                grid-template-columns: 350px 1fr 320px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }

            .nav-item span:not(.icon) {
                display: none;
            }

            .inventory-layout {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr;
            }

            .main-container {
                padding: 15px;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Top Header -->
    <div class="apex-header">
        <div class="header-left">
            <div class="oracle-logo">ORACLE</div>
            <span style="color: #fff; font-size: 14px;">Hospital Management System</span>
        </div>
        <div class="header-right">
            <div class="user-info">
                <div class="user-avatar">PI</div>
                <span>(Pharmacy Inventory)</span>
            </div>
            <span style="margin-right: 15px;">üåê Select Language ‚ñæ</span>
            <span>Main Application</span>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="main-layout">
        <!-- Left Sidebar Navigation -->
        <div class="sidebar">
            <div class="nav-item">
                <span class="icon">üè•</span>
                <span>Hospital Dashboard</span>
            </div>
            
            <div class="nav-item has-submenu" onclick="toggleSubmenu(this)">
                <span class="icon">üë•</span>
                <span>Patient Management</span>
                <span class="arrow">‚ñ∂</span>
            </div>
            <div class="nav-submenu">
                <div class="nav-item"><span>Patient Registration</span></div>
                <div class="nav-item"><span>Patient Search</span></div>
                <div class="nav-item"><span>Admission/Discharge</span></div>
                <div class="nav-item"><span>Emergency Triage</span></div>
            </div>

            <div class="nav-item has-submenu" onclick="toggleSubmenu(this)">
                <span class="icon">ü©∫</span>
                <span>Clinical Module</span>
                <span class="arrow">‚ñ∂</span>
            </div>
            <div class="nav-submenu">
                <div class="nav-item"><span>Medical Records</span></div>
                <div class="nav-item"><span>Vital Signs</span></div>
                <div class="nav-item"><span>Procedure Scheduling</span></div>
                <div class="nav-item"><span>Discharge Planning</span></div>
            </div>

            <div class="nav-item has-submenu" onclick="toggleSubmenu(this)">
                <span class="icon">üî¨</span>
                <span>Laboratory</span>
                <span class="arrow">‚ñ∂</span>
            </div>
            <div class="nav-submenu">
                <div class="nav-item"><span>Test Orders</span></div>
                <div class="nav-item"><span>Sample Tracking</span></div>
                <div class="nav-item"><span>Results Entry</span></div>
                <div class="nav-item"><span>Lab Reports</span></div>
            </div>

            <div class="nav-item has-submenu active" onclick="toggleSubmenu(this)">
                <span class="icon">üíä</span>
                <span>Pharmacy</span>
                <span class="arrow">‚ñº</span>
            </div>
            <div class="nav-submenu open">
                <div class="nav-item">
                    <span>Prescription Management</span>
                </div>
                <div class="nav-item active">
                    <span>Drug Inventory</span>
                </div>
                <div class="nav-item">
                    <span>Dispensing</span>
                </div>
                <div class="nav-item">
                    <span>Drug Interactions</span>
                </div>
            </div>

            <div class="nav-item has-submenu" onclick="toggleSubmenu(this)">
                <span class="icon">üí∞</span>
                <span>Billing & Finance</span>
                <span class="arrow">‚ñ∂</span>
            </div>
            <div class="nav-submenu">
                <div class="nav-item"><span>Invoice Generation</span></div>
                <div class="nav-item"><span>Insurance Claims</span></div>
                <div class="nav-item"><span>Payment Tracking</span></div>
                <div class="nav-item"><span>Financial Reports</span></div>
            </div>

            <div class="nav-item has-submenu" onclick="toggleSubmenu(this)">
                <span class="icon">üë®‚Äç‚öïÔ∏è</span>
                <span>Staff Management</span>
                <span class="arrow">‚ñ∂</span>
            </div>
            <div class="nav-submenu">
                <div class="nav-item"><span>Employee Records</span></div>
                <div class="nav-item"><span>Schedule Management</span></div>
                <div class="nav-item"><span>Department Assignment</span></div>
                <div class="nav-item"><span>Performance Tracking</span></div>
            </div>

            <div class="nav-item has-submenu" onclick="toggleSubmenu(this)">
                <span class="icon">ü§ñ</span>
                <span>AI Analytics</span>
                <span class="arrow">‚ñ∂</span>
            </div>
            <div class="nav-submenu">
                <div class="nav-item"><span>Risk Predictions</span></div>
                <div class="nav-item"><span>Diagnostic Assistance</span></div>
                <div class="nav-item"><span>Model Performance</span></div>
                <div class="nav-item"><span>Classification Results</span></div>
            </div>

            <div class="nav-item has-submenu" onclick="toggleSubmenu(this)">
                <span class="icon">‚öôÔ∏è</span>
                <span>Administration</span>
                <span class="arrow">‚ñ∂</span>
            </div>
            <div class="nav-submenu">
                <div class="nav-item"><span>System Configuration</span></div>
                <div class="nav-item"><span>User Management</span></div>
                <div class="nav-item"><span>Audit Reports</span></div>
                <div class="nav-item"><span>Security Settings</span></div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <div class="content-header">
                <div>
                    <div class="breadcrumb">
                        <a href="#">Home</a> ‚Ä∫ <a href="#">Pharmacy</a> ‚Ä∫ Drug Inventory
                    </div>
                    <h1 class="page-title">Drug Inventory Management</h1>
                </div>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="addNewDrug()">
                        ‚ûï Add Drug
                    </button>
                    <button class="btn btn-warning" onclick="createPurchaseOrder()">
                        üìã Purchase Order
                    </button>
                    <button class="btn btn-secondary" onclick="exportInventory()">
                        üì§ Export Report
                    </button>
                </div>
            </div>

            <div class="main-container">
                <!-- Three-column Drug Inventory Layout -->
                <div class="inventory-layout">
                    <!-- Left Panel - Inventory Search & Filters -->
                    <div class="inventory-search">
                        <div class="region-header">
                            <span class="icon">üîç</span>
                            Drug Inventory Search
                        </div>
                        
                        <div class="inventory-summary">
                            <div class="summary-cards">
                                <div class="summary-card">
                                    <div class="summary-number">1,247</div>
                                    <div class="summary-label">Total SKUs</div>
                                </div>
                                <div class="summary-card">
                                    <div class="summary-number">$125K</div>
                                    <div class="summary-label">Total Value</div>
                                </div>
                                <div class="summary-card alert">
                                    <div class="summary-number">23</div>
                                    <div class="summary-label">Low Stock</div>
                                </div>
                                <div class="summary-card critical">
                                    <div class="summary-number">8</div>
                                    <div class="summary-label">Out of Stock</div>
                                </div>
                            </div>
                        </div>

                        <div class="search-filters">
                            <div class="filter-group">
                                <label class="filter-label">Drug Search</label>
                                <input type="text" class="filter-input" placeholder="Drug name, NDC, or generic..." 
                                       id="drugSearchInput" oninput="searchDrugs()">
                            </div>
                            
                            <div class="filter-group">
                                <label class="filter-label">Category & Class</label>
                                <div class="filter-row">
                                    <select class="filter-select" id="categoryFilter" onchange="filterDrugs()">
                                        <option value="">All Categories</option>
                                        <option value="ANALGESICS">Analgesics</option>
                                        <option value="ANTIBIOTICS">Antibiotics</option>
                                        <option value="CARDIOVASCULAR">Cardiovascular</option>
                                        <option value="DIABETES">Diabetes</option>
                                        <option value="RESPIRATORY">Respiratory</option>
                                        <option value="CONTROLLED">Controlled Substances</option>
                                    </select>
                                    <select class="filter-select" id="statusFilter" onchange="filterDrugs()">
                                        <option value="">All Stock Status</option>
                                        <option value="ADEQUATE">Adequate Stock</option>
                                        <option value="LOW">Low Stock</option>
                                        <option value="OUT">Out of Stock</option>
                                        <option value="EXPIRING">Expiring Soon</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label class="filter-label">Supplier & Location</label>
                                <div class="filter-row">
                                    <select class="filter-select" id="supplierFilter" onchange="filterDrugs()">
                                        <option value="">All Suppliers</option>
                                        <option value="PHARMA_CORP">Pharma Corp</option>
                                        <option value="MED_SUPPLY">Medical Supply Co</option>
                                        <option value="GENERIC_PLUS">Generic Plus</option>
                                        <option value="SPECIALTY_DRUGS">Specialty Drugs Ltd</option>
                                    </select>
                                    <select class="filter-select" id="locationFilter" onchange="filterDrugs()">
                                        <option value="">All Locations</option>
                                        <option value="MAIN_PHARMACY">Main Pharmacy</option>
                                        <option value="EMERGENCY">Emergency Stock</option>
                                        <option value="ICU_SATELLITE">ICU Satellite</option>
                                        <option value="OR_STOCK">OR Stock Room</option>
                                    </select>
                                </div>
                            </div>
                            
                            <button class="search-button" onclick="searchDrugs()">
                                üîç Search Inventory
                            </button>
                        </div>

                        <div class="drugs-container" id="drugsContainer">
                            <!-- Drug inventory items will be loaded here -->
                        </div>
                    </div>

                    <!-- Center Panel - Inventory Management -->
                    <div class="inventory-content">
                        <div class="inventory-tabs">
                            <div class="inventory-tab active" onclick="switchTab('details', this)">Drug Details</div>
                            <div class="inventory-tab" onclick="switchTab('stock', this)">Stock Levels</div>
                            <div class="inventory-tab" onclick="switchTab('transactions', this)">Transactions</div>
                            <div class="inventory-tab" onclick="switchTab('analytics', this)">Analytics</div>
                        </div>

                        <div class="inventory-details" id="inventoryDetails">
                            <div id="defaultContent">
                                <div class="alert alert-info">
                                    <strong>üì¶ Drug Inventory Management</strong><br>
                                    Select a drug from the inventory list to view detailed information, manage stock levels, track lot numbers, and monitor expiration dates.
                                </div>

                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                                    <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; border: 1px solid #dee2e6;">
                                        <h4 style="margin-bottom: 10px; color: #333;">Inventory Status</h4>
                                        <div style="font-size: 12px; line-height: 1.6;">
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                <span>Active SKUs:</span>
                                                <span style="font-weight: 600;">1,247</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                <span>Low Stock Alerts:</span>
                                                <span style="font-weight: 600; color: #ffc107;">23</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                <span>Out of Stock:</span>
                                                <span style="font-weight: 600; color: #dc3545;">8</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between;">
                                                <span>Expiring (30 days):</span>
                                                <span style="font-weight: 600; color: #fd7e14;">15</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; border: 1px solid #dee2e6;">
                                        <h4 style="margin-bottom: 10px; color: #333;">Financial Summary</h4>
                                        <div style="font-size: 12px; line-height: 1.6;">
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                <span>Total Inventory Value:</span>
                                                <span style="font-weight: 600;">$125,450</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                <span>Monthly Consumption:</span>
                                                <span style="font-weight: 600;">$45,200</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                <span>Pending Orders:</span>
                                                <span style="font-weight: 600; color: #3d9aef;">$12,800</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between;">
                                                <span>Expired Write-offs:</span>
                                                <span style="font-weight: 600; color: #dc3545;">$1,250</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; border: 1px solid #dee2e6;">
                                        <h4 style="margin-bottom: 10px; color: #333;">Today's Activity</h4>
                                        <div style="font-size: 12px; line-height: 1.6;">
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                <span>Items Dispensed:</span>
                                                <span style="font-weight: 600;">127</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                <span>Items Received:</span>
                                                <span style="font-weight: 600; color: #28a745;">45</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                <span>Stock Adjustments:</span>
                                                <span style="font-weight: 600;">8</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between;">
                                                <span>Return to Vendor:</span>
                                                <span style="font-weight: 600;">3</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="selectedDrugContent" style="display: none;">
                                <!-- Selected drug details will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Right Panel - Actions & Alerts -->
                    <div class="inventory-panel">
                        <div class="panel-section">
                            <h4 class="section-title">
                                <span class="section-icon">üì±</span>
                                Barcode Scanner
                            </h4>
                            <div class="barcode-scanner">
                                <div class="scanner-icon">üì∑</div>
                                <div style="font-size: 12px; margin-bottom: 6px;">Scan Drug Barcode</div>
                                <input type="text" class="scanner-input" placeholder="NDC or Barcode" 
                                       id="barcodeInput" onchange="scanDrug(this.value)">
                            </div>
                        </div>

                        <div class="panel-section">
                            <h4 class="section-title">
                                <span class="section-icon">üö®</span>
                                Critical Alerts
                            </h4>
                            <div id="criticalAlerts">
                                <div class="alert-card critical">
                                    <div class="alert-title">Out of Stock</div>
                                    Amoxicillin 500mg - No units available
                                </div>
                                <div class="alert-card">
                                    <div class="alert-title">Expiring Soon</div>
                                    Insulin Rapid - Expires in 5 days
                                </div>
                                <div class="alert-card info">
                                    <div class="alert-title">Low Stock</div>
                                    Metformin 500mg - Only 15 units left
                                </div>
                            </div>
                        </div>

                        <div class="panel-section">
                            <h4 class="section-title">
                                <span class="section-icon">‚ö°</span>
                                Quick Actions
                            </h4>
                            <button class="action-button primary" onclick="adjustStock()">
                                <span class="action-icon">üìä</span>
                                Adjust Stock
                            </button>
                            <button class="action-button success" onclick="receiveShipment()">
                                <span class="action-icon">üì¶</span>
                                Receive Shipment
                            </button>
                            <button class="action-button warning" onclick="returnToVendor()">
                                <span class="action-icon">‚Ü©Ô∏è</span>
                                Return to Vendor
                            </button>
                            <button class="action-button" onclick="transferStock()">
                                <span class="action-icon">üîÑ</span>
                                Transfer Stock
                            </button>
                            <button class="action-button danger" onclick="markAsWaste()">
                                <span class="action-icon">üóëÔ∏è</span>
                                Mark as Waste
                            </button>
                        </div>

                        <div class="panel-section">
                            <h4 class="section-title">
                                <span class="section-icon">üìà</span>
                                Quick Stats
                            </h4>
                            <div class="quick-stats" id="quickStats">
                                <div class="stat-item">
                                    <div class="stat-number">-</div>
                                    <div class="stat-label">On Hand</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number">-</div>
                                    <div class="stat-label">On Order</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number">-</div>
                                    <div class="stat-label">Unit Cost</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number">-</div>
                                    <div class="stat-label">Total Value</div>
                                </div>
                            </div>
                        </div>

                        <div class="panel-section">
                            <h4 class="section-title">
                                <span class="section-icon">üè≠</span>
                                Supplier Information
                            </h4>
                            <div id="supplierInfo">
                                <div style="text-align: center; color: #666; font-size: 11px; padding: 10px;">
                                    Select a drug to view supplier details
                                </div>
                            </div>
                        </div>

                        <div class="panel-section">
                            <h4 class="section-title">
                                <span class="section-icon">üî¢</span>
                                Reorder Calculator
                            </h4>
                            <div class="form-group">
                                <label class="form-label">Monthly Usage</label>
                                <input type="number" class="form-input" id="monthlyUsage" placeholder="Units per month">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Lead Time (days)</label>
                                <input type="number" class="form-input" id="leadTime" placeholder="Days">
                            </div>
                            <button class="btn btn-primary" onclick="calculateReorder()" style="width: 100%;">
                                Calculate Reorder Point
                            </button>
                        </div>

                        <div class="panel-section">
                            <h4 class="section-title">
                                <span class="section-icon">üí¨</span>
                                Inventory Notes
                            </h4>
                            <textarea class="form-textarea" id="inventoryNotes" 
                                      placeholder="Add inventory notes or special handling instructions..." rows="3"></textarea>
                            <button class="btn btn-secondary" onclick="saveInventoryNotes()" style="margin-top: 8px; width: 100%;">
                                Save Notes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Stock Adjustment Modal -->
    <div id="stockModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìä Stock Adjustment</h3>
                <button class="modal-close" onclick="closeModal('stockModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="stockForm">
                    <div class="alert alert-info">
                        <strong>Adjusting inventory levels</strong> - All changes will be logged for audit purposes
                    </div>
                    
                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group">
                            <label class="form-label">Drug Name</label>
                            <input type="text" class="form-input" id="adjustDrugName" readonly>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Current Stock</label>
                            <input type="text" class="form-input" id="currentStock" readonly>
                        </div>
                    </div>

                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group">
                            <label class="form-label">Adjustment Type *</label>
                            <select class="form-select" name="adjustmentType" required>
                                <option value="">-- Select Type --</option>
                                <option value="INCREASE">Increase Stock</option>
                                <option value="DECREASE">Decrease Stock</option>
                                <option value="SET">Set Exact Amount</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Quantity *</label>
                            <input type="number" class="form-input" name="quantity" required placeholder="Enter quantity">
                        </div>
                    </div>

                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group">
                            <label class="form-label">Reason *</label>
                            <select class="form-select" name="reason" required>
                                <option value="">-- Select Reason --</option>
                                <option value="PHYSICAL_COUNT">Physical Count Adjustment</option>
                                <option value="EXPIRED">Expired Product Removal</option>
                                <option value="DAMAGED">Damaged Product</option>
                                <option value="THEFT_LOSS">Theft/Loss</option>
                                <option value="SYSTEM_ERROR">System Error Correction</option>
                                <option value="RECEIVING">Receiving Adjustment</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Lot Number</label>
                            <input type="text" class="form-input" name="lotNumber" placeholder="Optional">
                        </div>
                    </div>

                    <div class="form-row" style="margin-bottom: 15px;">
                        <div class="form-group">
                            <label class="form-label">Notes</label>
                            <textarea class="form-textarea" name="notes" rows="3"
                                      placeholder="Additional details about this adjustment..."></textarea>
                        </div>
                    </div>

                    <div style="display: flex; justify-content: flex-end; gap: 10px; padding-top: 20px; border-top: 1px solid #ddd; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('stockModal')">
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            üìä Apply Adjustment
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Sample data
        const drugsData = [
            {
                id: 'DRUG-001',
                name: 'Metformin',
                strength: '500mg',
                form: 'Tablet',
                ndc: '12345-678-90',
                genericName: 'Metformin Hydrochloride',
                category: 'DIABETES',
                onHand: 15,
                reorderPoint: 50,
                maxStock: 200,
                unitCost: 0.25,
                supplier: 'PHARMA_CORP',
                location: 'MAIN_PHARMACY',
                status: 'LOW',
                expiryStatus: 'ok',
                lots: [
                    { lotNumber: 'LOT001', quantity: 15, expiry: '2025-08-15', cost: 0.25 }
                ]
            },
            {
                id: 'DRUG-002',
                name: 'Amoxicillin',
                strength: '500mg',
                form: 'Capsule',
                ndc: '98765-432-10',
                genericName: 'Amoxicillin Trihydrate',
                category: 'ANTIBIOTICS',
                onHand: 0,
                reorderPoint: 25,
                maxStock: 100,
                unitCost: 0.75,
                supplier: 'MED_SUPPLY',
                location: 'MAIN_PHARMACY',
                status: 'OUT',
                expiryStatus: 'ok',
                lots: []
            },
            {
                id: 'DRUG-003',
                name: 'Atorvastatin',
                strength: '20mg',
                form: 'Tablet',
                ndc: '55555-777-88',
                genericName: 'Atorvastatin Calcium',
                category: 'CARDIOVASCULAR',
                onHand: 85,
                reorderPoint: 30,
                maxStock: 150,
                unitCost: 1.25,
                supplier: 'GENERIC_PLUS',
                location: 'MAIN_PHARMACY',
                status: 'ADEQUATE',
                expiryStatus: 'ok',
                lots: [
                    { lotNumber: 'LOT003', quantity: 60, expiry: '2025-12-20', cost: 1.25 },
                    { lotNumber: 'LOT004', quantity: 25, expiry: '2025-10-15', cost: 1.20 }
                ]
            },
            {
                id: 'DRUG-004',
                name: 'Insulin Rapid',
                strength: '100 units/mL',
                form: 'Injection',
                ndc: '11111-222-33',
                genericName: 'Insulin Aspart',
                category: 'DIABETES',
                onHand: 12,
                reorderPoint: 20,
                maxStock: 50,
                unitCost: 45.00,
                supplier: 'SPECIALTY_DRUGS',
                location: 'MAIN_PHARMACY',
                status: 'LOW',
                expiryStatus: 'warning',
                lots: [
                    { lotNumber: 'INS001', quantity: 12, expiry: '2024-12-20', cost: 45.00 }
                ]
            }
        ];

        let selectedDrug = null;
        let filteredDrugs = [...drugsData];
        let currentTab = 'details';

        // Navigation functionality
        function toggleSubmenu(item) {
            const submenu = item.nextElementSibling;
            const arrow = item.querySelector('.arrow');
            
            if (submenu && submenu.classList.contains('nav-submenu')) {
                submenu.classList.toggle('open');
                arrow.textContent = submenu.classList.contains('open') ? '‚ñº' : '‚ñ∂';
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadDrugsInventory();
        });

        // Load drugs inventory
        function loadDrugsInventory() {
            const container = document.getElementById('drugsContainer');
            
            container.innerHTML = filteredDrugs.map(drug => `
                <div class="drug-item ${getStockClass(drug)} ${selectedDrug?.id === drug.id ? 'selected' : ''}" 
                     onclick="selectDrug('${drug.id}')" data-drug-id="${drug.id}">
                    <div class="expiry-indicator ${drug.expiryStatus}"></div>
                    <div class="drug-header">
                        <div class="drug-name">${drug.name} ${drug.strength}</div>
                        <div class="stock-level stock-${drug.status.toLowerCase()}">${drug.status}</div>
                    </div>
                    <div class="drug-details">
                        ${drug.form} ‚Ä¢ NDC: ${drug.ndc}<br>
                        ${drug.category} ‚Ä¢ ${drug.location}
                    </div>
                    <div class="drug-meta">
                        <span>On Hand: ${drug.onHand}</span>
                        <span>Value: $${(drug.onHand * drug.unitCost).toFixed(2)}</span>
                    </div>
                </div>
            `).join('');
        }

        // Get stock class for styling
        function getStockClass(drug) {
            if (drug.onHand === 0) return 'out-of-stock';
            if (drug.onHand <= drug.reorderPoint) return 'low-stock';
            if (drug.expiryStatus === 'warning') return 'expiring-soon';
            return '';
        }

        // Select drug
        function selectDrug(drugId) {
            selectedDrug = drugsData.find(d => d.id === drugId);
            
            // Update UI selection
            document.querySelectorAll('.drug-item').forEach(item => {
                item.classList.remove('selected');
            });
            document.querySelector(`[data-drug-id="${drugId}"]`).classList.add('selected');
            
            // Update drug details
            updateDrugDetails();
            updateQuickStats();
            updateSupplierInfo();
        }

        // Update drug details
        function updateDrugDetails() {
            if (!selectedDrug) return;
            
            const defaultContent = document.getElementById('defaultContent');
            const selectedContent = document.getElementById('selectedDrugContent');
            
            defaultContent.style.display = 'none';
            selectedContent.style.display = 'block';
            
            if (currentTab === 'details') {
                selectedContent.innerHTML = `
                    <div class="drug-info-card">
                        <div class="drug-info-header">
                            <div>
                                <div class="drug-title">${selectedDrug.name} ${selectedDrug.strength}</div>
                                <div class="drug-subtitle">${selectedDrug.genericName}</div>
                            </div>
                            <div class="drug-status-badge stock-${selectedDrug.status.toLowerCase()}">${selectedDrug.status}</div>
                        </div>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">NDC Number:</span>
                                <span class="info-value">${selectedDrug.ndc}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Dosage Form:</span>
                                <span class="info-value">${selectedDrug.form}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Category:</span>
                                <span class="info-value">${selectedDrug.category}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Storage Location:</span>
                                <span class="info-value">${selectedDrug.location}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Unit Cost:</span>
                                <span class="info-value">$${selectedDrug.unitCost.toFixed(2)}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Total Value:</span>
                                <span class="info-value">$${(selectedDrug.onHand * selectedDrug.unitCost).toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                `;
            } else if (currentTab === 'stock') {
                selectedContent.innerHTML = `
                    <div class="drug-info-card">
                        <div class="drug-info-header">
                            <div>
                                <div class="drug-title">Stock Levels - ${selectedDrug.name}</div>
                                <div class="drug-subtitle">Lot tracking and expiration management</div>
                            </div>
                        </div>
                    </div>

                    <table class="stock-table">
                        <thead>
                            <tr>
                                <th>Lot Number</th>
                                <th>Quantity</th>
                                <th>Expiry Date</th>
                                <th>Unit Cost</th>
                                <th>Total Value</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${selectedDrug.lots.length > 0 ? selectedDrug.lots.map(lot => {
                                const isExpired = new Date(lot.expiry) < new Date();
                                const isExpiring = new Date(lot.expiry) < new Date(Date.now() + 30*24*60*60*1000);
                                const rowClass = isExpired ? 'lot-expired' : isExpiring ? 'lot-expiring' : '';
                                
                                return `
                                    <tr class="${rowClass}">
                                        <td>${lot.lotNumber}</td>
                                        <td>${lot.quantity}</td>
                                        <td>${formatDate(lot.expiry)}</td>
                                        <td>$${lot.cost.toFixed(2)}</td>
                                        <td>$${(lot.quantity * lot.cost).toFixed(2)}</td>
                                        <td>
                                            ${isExpired ? '‚ùå Expired' : isExpiring ? '‚ö†Ô∏è Expiring Soon' : '‚úÖ Good'}
                                        </td>
                                    </tr>
                                `;
                            }).join('') : `
                                <tr>
                                    <td colspan="6" style="text-align: center; color: #666; font-style: italic;">
                                        No stock available
                                    </td>
                                </tr>
                            `}
                        </tbody>
                    </table>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div style="background: #f8f9fa; padding: 12px; border-radius: 4px; border: 1px solid #dee2e6;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">Current Stock</div>
                            <div style="font-size: 18px; font-weight: bold; color: ${selectedDrug.onHand <= selectedDrug.reorderPoint ? '#dc3545' : '#28a745'};">
                                ${selectedDrug.onHand} units
                            </div>
                        </div>
                        <div style="background: #f8f9fa; padding: 12px; border-radius: 4px; border: 1px solid #dee2e6;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">Reorder Point</div>
                            <div style="font-size: 18px; font-weight: bold; color: #ffc107;">
                                ${selectedDrug.reorderPoint} units
                            </div>
                        </div>
                        <div style="background: #f8f9fa; padding: 12px; border-radius: 4px; border: 1px solid #dee2e6;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 4px;">Maximum Stock</div>
                            <div style="font-size: 18px; font-weight: bold; color: #3d9aef;">
                                ${selectedDrug.maxStock} units
                            </div>
                        </div>
                    </div>
                `;
            } else if (currentTab === 'transactions') {
                selectedContent.innerHTML = `
                    <div class="drug-info-card">
                        <div class="drug-info-header">
                            <div>
                                <div class="drug-title">Transaction History - ${selectedDrug.name}</div>
                                <div class="drug-subtitle">Recent inventory movements</div>
                            </div>
                        </div>
                    </div>

                    <div class="transaction-list">
                        ${generateSampleTransactions(selectedDrug).map(transaction => `
                            <div class="transaction-item">
                                <div class="transaction-header">
                                    <span class="transaction-type">${transaction.type}</span>
                                    <span class="transaction-date">${transaction.date}</span>
                                </div>
                                <div class="transaction-details">${transaction.details}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            } else if (currentTab === 'analytics') {
                selectedContent.innerHTML = `
                    <div class="drug-info-card">
                        <div class="drug-info-header">
                            <div>
                                <div class="drug-title">Analytics - ${selectedDrug.name}</div>
                                <div class="drug-subtitle">Usage patterns and forecasting</div>
                            </div>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; border: 1px solid #dee2e6;">
                            <h4 style="margin-bottom: 10px; color: #333;">Usage Statistics</h4>
                            <div style="font-size: 12px; line-height: 1.6;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span>Daily Average:</span>
                                    <span style="font-weight: 600;">3.2 units</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span>Weekly Average:</span>
                                    <span style="font-weight: 600;">22.4 units</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span>Monthly Projection:</span>
                                    <span style="font-weight: 600;">96 units</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Turnover Rate:</span>
                                    <span style="font-weight: 600;">12x/year</span>
                                </div>
                            </div>
                        </div>

                        <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; border: 1px solid #dee2e6;">
                            <h4 style="margin-bottom: 10px; color: #333;">Ordering Recommendations</h4>
                            <div style="font-size: 12px; line-height: 1.6;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span>Suggested Reorder:</span>
                                    <span style="font-weight: 600; color: #ffc107;">75 units</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span>Days Until Stockout:</span>
                                    <span style="font-weight: 600; color: #dc3545;">5 days</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span>Optimal Order Qty:</span>
                                    <span style="font-weight: 600; color: #28a745;">100 units</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Lead Time:</span>
                                    <span style="font-weight: 600;">3-5 days</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // Generate sample transactions
        function generateSampleTransactions(drug) {
            return [
                {
                    type: 'Dispensed',
                    date: '2024-12-15 14:30',
                    details: `5 units dispensed for prescription RX-2024-1215-001. Remaining: ${drug.onHand} units`
                },
                {
                    type: 'Stock Adjustment',
                    date: '2024-12-14 09:15',
                    details: 'Physical count adjustment: -2 units (damaged packaging)'
                },
                {
                    type: 'Received',
                    date: '2024-12-12 16:45',
                    details: 'Shipment received: +50 units from Pharma Corp, Lot #LOT001'
                },
                {
                    type: 'Dispensed',
                    date: '2024-12-12 11:20',
                    details: '3 units dispensed for prescription RX-2024-1212-045'
                }
            ];
        }

        // Update quick stats
        function updateQuickStats() {
            const quickStats = document.getElementById('quickStats');
            
            if (!selectedDrug) {
                quickStats.innerHTML = `
                    <div class="stat-item">
                        <div class="stat-number">-</div>
                        <div class="stat-label">On Hand</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">-</div>
                        <div class="stat-label">On Order</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">-</div>
                        <div class="stat-label">Unit Cost</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">-</div>
                        <div class="stat-label">Total Value</div>
                    </div>
                `;
                return;
            }
            
            quickStats.innerHTML = `
                <div class="stat-item">
                    <div class="stat-number">${selectedDrug.onHand}</div>
                    <div class="stat-label">On Hand</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">0</div>
                    <div class="stat-label">On Order</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">$${selectedDrug.unitCost.toFixed(2)}</div>
                    <div class="stat-label">Unit Cost</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">$${(selectedDrug.onHand * selectedDrug.unitCost).toFixed(2)}</div>
                    <div class="stat-label">Total Value</div>
                </div>
            `;
        }

        // Update supplier info
        function updateSupplierInfo() {
            const supplierInfo = document.getElementById('supplierInfo');
            
            if (!selectedDrug) {
                supplierInfo.innerHTML = '<div style="text-align: center; color: #666; font-size: 11px; padding: 10px;">Select a drug to view supplier details</div>';
                return;
            }
            
            const suppliers = {
                'PHARMA_CORP': { name: 'Pharma Corp Ltd', contact: '+20-2-123-4567', email: 'orders@pharmacorp.com' },
                'MED_SUPPLY': { name: 'Medical Supply Co', contact: '+20-2-987-6543', email: 'sales@medsupply.com' },
                'GENERIC_PLUS': { name: 'Generic Plus', contact: '+20-2-555-7788', email: 'info@genericplus.com' },
                'SPECIALTY_DRUGS': { name: 'Specialty Drugs Ltd', contact: '+20-2-111-2222', email: 'orders@specialtydrugs.com' }
            };
            
            const supplier = suppliers[selectedDrug.supplier];
            
            supplierInfo.innerHTML = `
                <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 3px; padding: 8px; font-size: 11px;">
                    <div style="font-weight: 600; margin-bottom: 4px;">${supplier.name}</div>
                    <div style="color: #666; line-height: 1.3;">
                        Phone: ${supplier.contact}<br>
                        Email: ${supplier.email}<br>
                        Lead Time: 3-5 business days
                    </div>
                </div>
            `;
        }

        // Switch tabs
        function switchTab(tabName, element) {
            document.querySelectorAll('.inventory-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            element.classList.add('active');
            currentTab = tabName;
            
            if (selectedDrug) {
                updateDrugDetails();
            }
        }

        // Search and filter functions
        function searchDrugs() {
            filterDrugs();
        }

        function filterDrugs() {
            const searchTerm = document.getElementById('drugSearchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const supplierFilter = document.getElementById('supplierFilter').value;
            const locationFilter = document.getElementById('locationFilter').value;
            
            filteredDrugs = drugsData.filter(drug => {
                const matchesSearch = !searchTerm || 
                    drug.name.toLowerCase().includes(searchTerm) ||
                    drug.genericName.toLowerCase().includes(searchTerm) ||
                    drug.ndc.includes(searchTerm);
                
                const matchesCategory = !categoryFilter || drug.category === categoryFilter;
                const matchesStatus = !statusFilter || drug.status === statusFilter;
                const matchesSupplier = !supplierFilter || drug.supplier === supplierFilter;
                const matchesLocation = !locationFilter || drug.location === locationFilter;
                
                return matchesSearch && matchesCategory && matchesStatus && 
                       matchesSupplier && matchesLocation;
            });
            
            loadDrugsInventory();
        }

        // Barcode scanning
        function scanDrug(barcode) {
            if (!barcode) return;
            
            const drug = drugsData.find(d => d.ndc === barcode || d.id === barcode);
            if (drug) {
                selectDrug(drug.id);
                showAlert('success', `Drug ${drug.name} found and selected.`);
            } else {
                showAlert('warning', `Drug with barcode ${barcode} not found.`);
            }
            
            // Clear input
            document.getElementById('barcodeInput').value = '';
        }

        // Action functions
        function adjustStock() {
            if (!selectedDrug) {
                showAlert('warning', 'Please select a drug first.');
                return;
            }
            
            document.getElementById('adjustDrugName').value = `${selectedDrug.name} ${selectedDrug.strength}`;
            document.getElementById('currentStock').value = selectedDrug.onHand;
            document.getElementById('stockModal').style.display = 'block';
        }

        function receiveShipment() {
            showAlert('info', 'Shipment receiving workflow would open here.');
        }

        function returnToVendor() {
            if (!selectedDrug) {
                showAlert('warning', 'Please select a drug first.');
                return;
            }
            
            showAlert('info', `Return to vendor workflow for ${selectedDrug.name} would open here.`);
        }

        function transferStock() {
            if (!selectedDrug) {
                showAlert('warning', 'Please select a drug first.');
                return;
            }
            
            showAlert('info', `Stock transfer workflow for ${selectedDrug.name} would open here.`);
        }

        function markAsWaste() {
            if (!selectedDrug) {
                showAlert('warning', 'Please select a drug first.');
                return;
            }
            
            const quantity = prompt(`Enter quantity to mark as waste for ${selectedDrug.name}:`);
            if (quantity && !isNaN(quantity) && quantity > 0) {
                showAlert('warning', `${quantity} units of ${selectedDrug.name} marked as waste.`);
            }
        }

        function calculateReorder() {
            const monthlyUsage = document.getElementById('monthlyUsage').value;
            const leadTime = document.getElementById('leadTime').value;
            
            if (!monthlyUsage || !leadTime) {
                showAlert('warning', 'Please enter monthly usage and lead time.');
                return;
            }
            
            const dailyUsage = monthlyUsage / 30;
            const reorderPoint = Math.ceil(dailyUsage * leadTime * 1.2); // 20% safety stock
            
            showAlert('success', `Recommended reorder point: ${reorderPoint} units`);
        }

        function saveInventoryNotes() {
            const notes = document.getElementById('inventoryNotes').value;
            if (notes.trim()) {
                showAlert('success', 'Inventory notes saved successfully.');
            }
        }

        // Header action functions
        function addNewDrug() {
            showAlert('info', 'Add new drug interface would open here.');
        }

        function createPurchaseOrder() {
            showAlert('info', 'Purchase order creation interface would open here.');
        }

        function exportInventory() {
            showAlert('info', 'Exporting inventory report...');
        }

        // Stock form submission
        document.getElementById('stockForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const adjustmentData = {};
            
            for (let [key, value] of formData.entries()) {
                adjustmentData[key] = value;
            }
            
            // Simulate stock adjustment
            if (selectedDrug) {
                const quantity = parseInt(adjustmentData.quantity);
                
                switch(adjustmentData.adjustmentType) {
                    case 'INCREASE':
                        selectedDrug.onHand += quantity;
                        break;
                    case 'DECREASE':
                        selectedDrug.onHand = Math.max(0, selectedDrug.onHand - quantity);
                        break;
                    case 'SET':
                        selectedDrug.onHand = quantity;
                        break;
                }
                
                // Update status based on new stock level
                if (selectedDrug.onHand === 0) {
                    selectedDrug.status = 'OUT';
                } else if (selectedDrug.onHand <= selectedDrug.reorderPoint) {
                    selectedDrug.status = 'LOW';
                } else {
                    selectedDrug.status = 'ADEQUATE';
                }
                
                loadDrugsInventory();
                updateDrugDetails();
                updateQuickStats();
            }
            
            closeModal('stockModal');
            showAlert('success', `Stock adjustment completed for ${selectedDrug.name}.`);
        });

        // Modal functions
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Utility functions
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString();
        }

        function showAlert(type, message) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            document.querySelector('.main-container').insertBefore(alertDiv, document.querySelector('.main-container').firstChild);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        console.log('Drug Inventory Management System Initialized');
    </script>
</body>
</html>